{"version":3,"sources":["webpack:///path---what-the-adt-p-02-53135abdca4e26c01476.js","webpack:///./.cache/json/what-the-adt-p-02.json"],"names":["webpackJsonp","661","module","exports","data","site","siteMetadata","title","author","markdownRemark","id","html","frontmatter","path","date","pathContext","slug","previous","fields","next"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,uBAAAC,OAAA,mBAA0DC,gBAAmBC,GAAA,qIAAAC,KAAA;AAAyw5BC,aAAq/IC,KAAA,oBAAAN,MAAA,8CAAAO,KAAA,kBAAyGC,aAAgBC,KAAA,qBAAAC,UAAwCC,QAAUF,KAAA,sBAA4BJ,aAAgBC,KAAA,oBAAAN,MAAA,8DAAgGY,KAAA","file":"path---what-the-adt-p-02-53135abdca4e26c01476.js","sourcesContent":["webpackJsonp([242294865920579],{\n\n/***/ 661:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"(shatteredaesthetic)\",\"author\":\"Jason Polhemus\"}},\"markdownRemark\":{\"id\":\"/Users/travis/build/shatteredaesthetic/shatteredaesthetic.github.io/content/what-the-adt-p02.md absPath of file >>> MarkdownRemark\",\"html\":\"<h2>Purescript, Part 2: We Need Limitations</h2>\\n<p>Welcome back! It certainly has been awhile, but it’s nice to know we’ve got the kind of relationship where we can just pick up where we left off. Well, we have that with the code, anyway.</p>\\n<p>When we left off, we had ported our game from javascript into purescript. There’s still some problems, though: we can just keep guessing until we get it right. That won’t do for a game: that gets boring really fast. We really should limit the number of our guesses, to make things interesting. Let’s do that, then.</p>\\n<p>Code is up on <a href=\\\"https://gitlab.com/shatteredaesthetic/cipher-guess-ps/tree/what-adt-p02\\\">this repo</a>.</p>\\n<h4>Adjusting Our Types</h4>\\n<p>The first thing we do is add another <code class=\\\"language-text\\\">Int</code> to be our number of guesses. Great, but…where do we put it? It makes sense to put it in the <code class=\\\"language-text\\\">GameState</code>, since it is only used within the logic, and will change with use, so let’s add it there:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token keyword\\\">data</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token constant\\\">Int</span></code></pre>\\n      </div>\\n<p>Which <code class=\\\"language-text\\\">Int</code> is which, now? It’s hard to say…we should create some aliases for these Ints, so we can make our intentions clearer.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token keyword\\\">type</span> <span class=\\\"token constant\\\">Target</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Int</span>\\n\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token constant\\\">Guesses</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Int</span>\\n\\n<span class=\\\"token keyword\\\">data</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token constant\\\">Guesses</span> <span class=\\\"token constant\\\">Target</span></code></pre>\\n      </div>\\n<p>Much nicer. We made our aliases, and fixed our <code class=\\\"language-text\\\">GameState</code> type to use them. The type now self-documents, which is very nice. Let’s continue.</p>\\n<h4>Fixing Our Logic</h4>\\n<p>Let’s take a look at our existing <code class=\\\"language-text\\\">game</code> function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token constant\\\">GameEnvironment</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">ask</span>\\n  <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">target</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">get</span>\\n  <span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">target</span></code></pre>\\n      </div>\\n<p>We’ve changed the shape of our <code class=\\\"language-text\\\">GameState</code>, so we need to change this function. We need the <code class=\\\"language-text\\\">Guesses</code> bit in the <code class=\\\"language-text\\\">logic</code> function, so we don’t really need to unwrap <code class=\\\"language-text\\\">GameState</code>. We’ll change this to just get the state, then we’ll pass that into our call to <code class=\\\"language-text\\\">logic</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token constant\\\">GameEnvironment</span> <span class=\\\"token hvariable\\\">cfg</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">ask</span>\\n  <span class=\\\"token hvariable\\\">state</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">get</span>\\n  <span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token hvariable\\\">cfg</span> <span class=\\\"token hvariable\\\">state</span></code></pre>\\n      </div>\\n<p>Now the type signature of <code class=\\\"language-text\\\">logic</code> needs to be updated, to reflect that it’s now given the whole <code class=\\\"language-text\\\">GameState</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>We’ll unwrap the <code class=\\\"language-text\\\">GameState</code> type at the outset, so we can check our number of guesses. We’ll add a new first guard that checks to see if <code class=\\\"language-text\\\">guesses</code> is 0. If it is, we’ll end the game with a message, telling the player what the <code class=\\\"language-text\\\">target</code> was. Right now we end the game if the player gets the guess right (within a tolerance) by returning the <code class=\\\"language-text\\\">target</code> in a <code class=\\\"language-text\\\">Just</code>, so let’s do that here as well.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>Great, now we need to decrement our number of guesses each time we’re given a bad one. We only need to change a piece of the <code class=\\\"language-text\\\">GameState</code>, so, in each guard that returns a <code class=\\\"language-text\\\">Nothing</code>, we’ll add this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>This puts a new state into the <code class=\\\"language-text\\\">GameState</code>, decrementing the guesses. That’s actually all we have to do here, so let’s see the function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">l</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too low for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">h</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too high for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's it, Exactly!\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too low, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too high, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token builtin\\\">otherwise</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Close Enough! The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>Our logic is good, but we’re not quite finished.</p>\\n<h4>One Final Thing</h4>\\n<p>In our <code class=\\\"language-text\\\">main</code> function, we create our <code class=\\\"language-text\\\">GameState</code> with only the target, but now it also needs a number of <code class=\\\"language-text\\\">Guesses</code>. We should probably add that, to appease the compiler gods:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">main</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Effect</span> <span class=\\\"token constant\\\">Unit</span>\\n<span class=\\\"token hvariable\\\">main</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">void</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token keyword\\\">let</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">gameEnvironment</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token number\\\">100</span> <span class=\\\"token number\\\">3</span>\\n  <span class=\\\"token hvariable\\\">rnd</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">randomInt</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token number\\\">100</span>\\n  <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token hvariable\\\">rnd</span></code></pre>\\n      </div>\\n<p>And we’re done! Boom! All that’s left is to play the game and revel in our smartness. We try one number…wrong. Another number…wrong. Another number…wrong, Another…wrong. Another…wrong. Wait a minute, something isn’t working here.</p>\\n<h4>A Big Problem</h4>\\n<p>The way it’s written <em>looks</em> really good, and it compiles nicely, but…it doesn’t work! Every wrong guess, we pass the initial <code class=\\\"language-text\\\">GameState</code> back in. The new state we <code class=\\\"language-text\\\">put</code> in within <code class=\\\"language-text\\\">logic</code> gets obliterated. We need to fix something within the <code class=\\\"language-text\\\">runGame</code> function to get the updated state.</p>\\n<h3>A Big Solution</h3>\\n<p>The best solution I see requires only a few small changes. Let’s look at <code class=\\\"language-text\\\">logic</code>: it returns a <code class=\\\"language-text\\\">Game (Maybe Int)</code>, returning the <code class=\\\"language-text\\\">target</code>, but we never do anything with that returned value; it gets ignored. What we do need from <code class=\\\"language-text\\\">logic</code>, though, is the updated state. what if we returned that instead? The solution, then, is to invert which branch of the <code class=\\\"language-text\\\">Maybe</code> each possibility returns: the correct answers now return the <code class=\\\"language-text\\\">Nothing</code>, and the wrong answers return a <code class=\\\"language-text\\\">Just GameState</code> with the updated state. We can then remove all calls to <code class=\\\"language-text\\\">put</code>, since we no longer need them. Now our function looks like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">GameState</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">l</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too low for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">h</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too high for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's it, Exactly!\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too low, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too high, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token builtin\\\">otherwise</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Close Enough! The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span></code></pre>\\n      </div>\\n<p>Great, now we need to change the type signature of <code class=\\\"language-text\\\">game</code> to</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">GameState</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>We also need to change the <code class=\\\"language-text\\\">lineHandler</code> function within <code class=\\\"language-text\\\">runGame</code> to flip the results and feed the new state to the recalling of <code class=\\\"language-text\\\">runGame</code>.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">lineHandler</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">String</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Effect</span> <span class=\\\"token constant\\\">Unit</span>\\n    <span class=\\\"token hvariable\\\">lineHandler</span> <span class=\\\"token hvariable\\\">input</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">case</span> <span class=\\\"token hvariable\\\">fromStringAs</span> <span class=\\\"token hvariable\\\">decimal</span> <span class=\\\"token hvariable\\\">input</span> <span class=\\\"token keyword\\\">of</span>\\n        <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n          <span class=\\\"token keyword\\\">let</span> <span class=\\\"token constant\\\">Tuple</span> <span class=\\\"token hvariable\\\">result</span> <span class=\\\"token hvariable\\\">written</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">evalRWS</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">state</span>\\n          <span class=\\\"token hvariable\\\">for_</span> <span class=\\\"token hvariable\\\">written</span> <span class=\\\"token builtin\\\">log</span>\\n          <span class=\\\"token keyword\\\">case</span> <span class=\\\"token hvariable\\\">result</span> <span class=\\\"token keyword\\\">of</span>\\n            <span class=\\\"token constant\\\">Nothing</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n              <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n            <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">newSt</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n              <span class=\\\"token builtin\\\">log</span> <span class=\\\"token string\\\">\\\"Guess again:\\\"</span>\\n              <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n              <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">newSt</span>\\n        <span class=\\\"token constant\\\">Nothing</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n          <span class=\\\"token builtin\\\">log</span> <span class=\\\"token string\\\">\\\"Try again, but with a whole number this time.\\\"</span>\\n          <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n          <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">state</span></code></pre>\\n      </div>\\n<p>Now it’s working!</p>\\n<h4>To Be Continued…</h4>\\n<p>We’ve successfully limited our guesses. We can now be a Winner…or a Loser. The game functions nicely.</p>\\n<p>But it can be a bit hard to read the screen sometimes. Perhaps a little color can help the experience of playing. Next time we’ll color the responses to aid the UX, and it’ll come out much sooner than this one did.</p>\",\"frontmatter\":{\"path\":\"/what-the-adt-p02\",\"title\":\"What the ADT Purescript 02 - Setting Limits\",\"date\":\"May 28, 2019\"}}},\"pathContext\":{\"slug\":\"/what-the-adt-p02/\",\"previous\":{\"fields\":{\"slug\":\"/what-the-adt-p01/\"},\"frontmatter\":{\"path\":\"/what-the-adt-p01\",\"title\":\"What the ADT Purescript 01 - Trying our Hand at a Real FP\"}},\"next\":null}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---what-the-adt-p-02-53135abdca4e26c01476.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"(shatteredaesthetic)\",\"author\":\"Jason Polhemus\"}},\"markdownRemark\":{\"id\":\"/Users/travis/build/shatteredaesthetic/shatteredaesthetic.github.io/content/what-the-adt-p02.md absPath of file >>> MarkdownRemark\",\"html\":\"<h2>Purescript, Part 2: We Need Limitations</h2>\\n<p>Welcome back! It certainly has been awhile, but it’s nice to know we’ve got the kind of relationship where we can just pick up where we left off. Well, we have that with the code, anyway.</p>\\n<p>When we left off, we had ported our game from javascript into purescript. There’s still some problems, though: we can just keep guessing until we get it right. That won’t do for a game: that gets boring really fast. We really should limit the number of our guesses, to make things interesting. Let’s do that, then.</p>\\n<p>Code is up on <a href=\\\"https://gitlab.com/shatteredaesthetic/cipher-guess-ps/tree/what-adt-p02\\\">this repo</a>.</p>\\n<h4>Adjusting Our Types</h4>\\n<p>The first thing we do is add another <code class=\\\"language-text\\\">Int</code> to be our number of guesses. Great, but…where do we put it? It makes sense to put it in the <code class=\\\"language-text\\\">GameState</code>, since it is only used within the logic, and will change with use, so let’s add it there:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token keyword\\\">data</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token constant\\\">Int</span></code></pre>\\n      </div>\\n<p>Which <code class=\\\"language-text\\\">Int</code> is which, now? It’s hard to say…we should create some aliases for these Ints, so we can make our intentions clearer.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token keyword\\\">type</span> <span class=\\\"token constant\\\">Target</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Int</span>\\n\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token constant\\\">Guesses</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Int</span>\\n\\n<span class=\\\"token keyword\\\">data</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token constant\\\">Guesses</span> <span class=\\\"token constant\\\">Target</span></code></pre>\\n      </div>\\n<p>Much nicer. We made our aliases, and fixed our <code class=\\\"language-text\\\">GameState</code> type to use them. The type now self-documents, which is very nice. Let’s continue.</p>\\n<h4>Fixing Our Logic</h4>\\n<p>Let’s take a look at our existing <code class=\\\"language-text\\\">game</code> function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token constant\\\">GameEnvironment</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">ask</span>\\n  <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">target</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">get</span>\\n  <span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">target</span></code></pre>\\n      </div>\\n<p>We’ve changed the shape of our <code class=\\\"language-text\\\">GameState</code>, so we need to change this function. We need the <code class=\\\"language-text\\\">Guesses</code> bit in the <code class=\\\"language-text\\\">logic</code> function, so we don’t really need to unwrap <code class=\\\"language-text\\\">GameState</code>. We’ll change this to just get the state, then we’ll pass that into our call to <code class=\\\"language-text\\\">logic</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token constant\\\">GameEnvironment</span> <span class=\\\"token hvariable\\\">cfg</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">ask</span>\\n  <span class=\\\"token hvariable\\\">state</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">get</span>\\n  <span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token hvariable\\\">cfg</span> <span class=\\\"token hvariable\\\">state</span></code></pre>\\n      </div>\\n<p>Now the type signature of <code class=\\\"language-text\\\">logic</code> needs to be updated, to reflect that it’s now given the whole <code class=\\\"language-text\\\">GameState</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>We’ll unwrap the <code class=\\\"language-text\\\">GameState</code> type at the outset, so we can check our number of guesses. We’ll add a new first guard that checks to see if <code class=\\\"language-text\\\">guesses</code> is 0. If it is, we’ll end the game with a message, telling the player what the <code class=\\\"language-text\\\">target</code> was. Right now we end the game if the player gets the guess right (within a tolerance) by returning the <code class=\\\"language-text\\\">target</code> in a <code class=\\\"language-text\\\">Just</code>, so let’s do that here as well.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>Great, now we need to decrement our number of guesses each time we’re given a bad one. We only need to change a piece of the <code class=\\\"language-text\\\">GameState</code>, so, in each guard that returns a <code class=\\\"language-text\\\">Nothing</code>, we’ll add this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>This puts a new state into the <code class=\\\"language-text\\\">GameState</code>, decrementing the guesses. That’s actually all we have to do here, so let’s see the function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">l</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too low for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">h</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too high for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's it, Exactly!\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too low, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too high, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">put</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token builtin\\\">otherwise</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Close Enough! The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">t</span></code></pre>\\n      </div>\\n<p>Our logic is good, but we’re not quite finished.</p>\\n<h4>One Final Thing</h4>\\n<p>In our <code class=\\\"language-text\\\">main</code> function, we create our <code class=\\\"language-text\\\">GameState</code> with only the target, but now it also needs a number of <code class=\\\"language-text\\\">Guesses</code>. We should probably add that, to appease the compiler gods:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">main</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Effect</span> <span class=\\\"token constant\\\">Unit</span>\\n<span class=\\\"token hvariable\\\">main</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">void</span> <span class=\\\"token keyword\\\">do</span>\\n  <span class=\\\"token keyword\\\">let</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">gameEnvironment</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token number\\\">100</span> <span class=\\\"token number\\\">3</span>\\n  <span class=\\\"token hvariable\\\">rnd</span> <span class=\\\"token operator\\\">&lt;-</span> <span class=\\\"token hvariable\\\">randomInt</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token number\\\">100</span>\\n  <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token hvariable\\\">rnd</span></code></pre>\\n      </div>\\n<p>And we’re done! Boom! All that’s left is to play the game and revel in our smartness. We try one number…wrong. Another number…wrong. Another number…wrong, Another…wrong. Another…wrong. Wait a minute, something isn’t working here.</p>\\n<h4>A Big Problem</h4>\\n<p>The way it’s written <em>looks</em> really good, and it compiles nicely, but…it doesn’t work! Every wrong guess, we pass the initial <code class=\\\"language-text\\\">GameState</code> back in. The new state we <code class=\\\"language-text\\\">put</code> in within <code class=\\\"language-text\\\">logic</code> gets obliterated. We need to fix something within the <code class=\\\"language-text\\\">runGame</code> function to get the updated state.</p>\\n<h3>A Big Solution</h3>\\n<p>The best solution I see requires only a few small changes. Let’s look at <code class=\\\"language-text\\\">logic</code>: it returns a <code class=\\\"language-text\\\">Game (Maybe Int)</code>, returning the <code class=\\\"language-text\\\">target</code>, but we never do anything with that returned value; it gets ignored. What we do need from <code class=\\\"language-text\\\">logic</code>, though, is the updated state. what if we returned that instead? The solution, then, is to invert which branch of the <code class=\\\"language-text\\\">Maybe</code> each possibility returns: the correct answers now return the <code class=\\\"language-text\\\">Nothing</code>, and the wrong answers return a <code class=\\\"language-text\\\">Just GameState</code> with the updated state. We can then remove all calls to <code class=\\\"language-text\\\">put</code>, since we no longer need them. Now our function looks like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">GameState</span>\\n      <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">GameState</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token hvariable\\\">logic</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token hvariable\\\">low</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">l</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">high</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">h</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token hvariable\\\">tolerance</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">GameState</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token hvariable\\\">t</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Game Over! You're out of guesses. The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">l</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too low for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">h</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"Too high for bounds.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's it, Exactly!\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too low, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token hvariable\\\">g</span> <span class=\\\"token operator\\\">></span> <span class=\\\"token hvariable\\\">t</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token hvariable\\\">tol</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token string\\\">\\\"That's too high, try again.\\\"</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">Just</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token constant\\\">GameState</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">guesses</span> <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">t</span>\\n  <span class=\\\"token operator\\\">|</span> <span class=\\\"token builtin\\\">otherwise</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">do</span>\\n    <span class=\\\"token hvariable\\\">tell</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token hvariable\\\">A.singleton</span> <span class=\\\"token operator\\\">$</span> <span class=\\\"token string\\\">\\\"Close Enough! The number was \\\"</span> <span class=\\\"token operator\\\">&lt;></span> <span class=\\\"token builtin\\\">show</span> <span class=\\\"token hvariable\\\">t</span>\\n    <span class=\\\"token hvariable\\\">pure</span> <span class=\\\"token constant\\\">Nothing</span></code></pre>\\n      </div>\\n<p>Great, now we need to change the type signature of <code class=\\\"language-text\\\">game</code> to</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">Int</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Game</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">Maybe</span> <span class=\\\"token constant\\\">GameState</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>We also need to change the <code class=\\\"language-text\\\">lineHandler</code> function within <code class=\\\"language-text\\\">runGame</code> to flip the results and feed the new state to the recalling of <code class=\\\"language-text\\\">runGame</code>.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-haskell\\\"><code class=\\\"language-haskell\\\"><span class=\\\"token hvariable\\\">lineHandler</span> <span class=\\\"token operator\\\">::</span> <span class=\\\"token constant\\\">String</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token constant\\\">Effect</span> <span class=\\\"token constant\\\">Unit</span>\\n    <span class=\\\"token hvariable\\\">lineHandler</span> <span class=\\\"token hvariable\\\">input</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">case</span> <span class=\\\"token hvariable\\\">fromStringAs</span> <span class=\\\"token hvariable\\\">decimal</span> <span class=\\\"token hvariable\\\">input</span> <span class=\\\"token keyword\\\">of</span>\\n        <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">guess</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n          <span class=\\\"token keyword\\\">let</span> <span class=\\\"token constant\\\">Tuple</span> <span class=\\\"token hvariable\\\">result</span> <span class=\\\"token hvariable\\\">written</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token hvariable\\\">evalRWS</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token hvariable\\\">game</span> <span class=\\\"token hvariable\\\">guess</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">state</span>\\n          <span class=\\\"token hvariable\\\">for_</span> <span class=\\\"token hvariable\\\">written</span> <span class=\\\"token builtin\\\">log</span>\\n          <span class=\\\"token keyword\\\">case</span> <span class=\\\"token hvariable\\\">result</span> <span class=\\\"token keyword\\\">of</span>\\n            <span class=\\\"token constant\\\">Nothing</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n              <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n            <span class=\\\"token constant\\\">Just</span> <span class=\\\"token hvariable\\\">newSt</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n              <span class=\\\"token builtin\\\">log</span> <span class=\\\"token string\\\">\\\"Guess again:\\\"</span>\\n              <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n              <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">newSt</span>\\n        <span class=\\\"token constant\\\">Nothing</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">do</span>\\n          <span class=\\\"token builtin\\\">log</span> <span class=\\\"token string\\\">\\\"Try again, but with a whole number this time.\\\"</span>\\n          <span class=\\\"token hvariable\\\">RL.close</span> <span class=\\\"token hvariable\\\">interface</span>\\n          <span class=\\\"token hvariable\\\">runGame</span> <span class=\\\"token hvariable\\\">env</span> <span class=\\\"token hvariable\\\">state</span></code></pre>\\n      </div>\\n<p>Now it’s working!</p>\\n<h4>To Be Continued…</h4>\\n<p>We’ve successfully limited our guesses. We can now be a Winner…or a Loser. The game functions nicely.</p>\\n<p>But it can be a bit hard to read the screen sometimes. Perhaps a little color can help the experience of playing. Next time we’ll color the responses to aid the UX, and it’ll come out much sooner than this one did.</p>\",\"frontmatter\":{\"path\":\"/what-the-adt-p02\",\"title\":\"What the ADT Purescript 02 - Setting Limits\",\"date\":\"May 28, 2019\"}}},\"pathContext\":{\"slug\":\"/what-the-adt-p02/\",\"previous\":{\"fields\":{\"slug\":\"/what-the-adt-p01/\"},\"frontmatter\":{\"path\":\"/what-the-adt-p01\",\"title\":\"What the ADT Purescript 01 - Trying our Hand at a Real FP\"}},\"next\":null}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/what-the-adt-p-02.json\n// module id = 661\n// module chunks = 242294865920579"],"sourceRoot":""}